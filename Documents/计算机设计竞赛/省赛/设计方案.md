<h1 align= "center" >设计思路</h1>

### 1.作品背景

​        心血管疾病是我国乃至世界最为严重的疾病之一。我国现有心血管病患病人数约2.9亿，并且还在逐年上升，而心血管疾病中，又以冠状动脉疾病最为常见。冠心病、心绞痛、心肌梗死等都属于冠脉疾病。除了死亡危险，冠状动脉疾病的高发病率和高致残率给社会、家庭和患者个人带来了沉重的经济负担和心理负担，其相关诊断和治疗受到医疗界的重视，国家和人民对此亦十分关注。如今，随着医学影像技术的发展进步，心脏成像已不再是难题，然而如何从医学影像图中准确提取冠状动脉以进行后续诊断仍是研究者持续关注的内容。



<center><b>图1 心脏CT图像</b></center>

​        人工诊断对于医生的能力和经验有相当高的要求。从图中可以看出，冠脉（箭头指向部分）在CT图像中的占比少，对比度低，就算经验丰富的医生也容易漏看或者看起来很困难，不仅诊断的时间成本较高，而且也难以达到精确。因此，在高精准度、高效率、自动化的发展趋势下，对冠脉疾病的自动化计算机辅助诊断的需求日益迫切。心脏CT图像不但能够反映解剖形态，而且包含大量心脏功能信息，因此利用CT图像对冠脉疾病进行临床诊断已成为当前主流方法之一。为提高其准确性和效率，本作品以心脏CT数据图像处理为主要研究内容，基于深度学习方法，重点研究冠状动脉的管腔分割等关键算法。我们采用创新性的网络结构训练神经网络进行自动冠脉分割，得到了良好的效果，并编写了可视化程序直观展示分割结果，以达到辅助诊断的目的。

 

### 2.设计理念

​        我们的作品主要分为两个部分：神经网络部分和可视化程序部分。

​        为了实现自动化的辅助诊断，我们采用了深度学习方法，希望训练出在CT图像冠脉分割任务上表现良好的神经网络。其中，由于训练网络需要已标注的训练集，但是医学CT图像训练集上标注困难，训练样本少，另有隐私保护等因素，这使得耗费大量时间和成本在人工标注上变得不现实。在缺少数据标签的情况下，传统的全监督训练方式难以给出令人满意的结果。于是，本作品基于用更少的数据标签训练的理念，采用了强弱监督结合的方式训练网络。同时，为了使得训练出的网络能够达到和标签充足的全监督相媲美的效果，我们从训练模型下手，提出了一种新的考生-考官训练模型（**Examinee-Examiner Network**）来训练网络。该模型的设计思路是通过考官网络对考生网络的评判和监督，加强考生网络的收敛能力，以此减少或抵消缺少数据标签的问题，并提高分割的精确度。

​        神经网络训练完成后，为了将结果直观展示，我们设计并编写了对应的可视化程序CASeg（**Coronary artery segmentation**）。



<center><b>图2 CASeg程序界面截图</b></center>

​        如图所示，我们对原始的心脏CT数据进行建模，将CT断层图像还原成3D心脏图，使得没有CT阅片技能和经验的使用者也可以直观看到心脏的情况，降低了使用门槛。冠脉的标签也可以直接叠在心脏图像上显示；如果输入一张没有标签的原始心脏图片，利用训练好的神经网络就能直接对该图片进行预测，输出冠脉分割结果，叠加显示在图片上。我们设计程序的理念是将心脏CT图和冠脉标签进行建模，以更加方便快捷清楚地观察血管的情况，屏蔽掉周围其他的组织结构，从而进行进一步的诊断和规划，达到辅助诊断的目的。

 

### 3.技术方案

#### 神经网络部分：

​        鉴于精确的冠脉管腔标签稀少，我们希望用较少的标注数据训练出分割效果较好的神经网络，于是我们采用考生-考官训练模型（**Examinee-Examiner Network**）来进行训练。在此模型中，考生网络是根据管腔标签对原心脏CT图像进行分割预测的主体；而考官网络负责学习管腔标签和高斯增强后中心线标签之间的映射关系，作为前提条件。在此基础上，经训练后的考官网络可用来评估考生网络的预测输出成果，并反馈至后者，达到监督训练考生网络的目的。

​        本项目所用神经网络都采用U-net的结构。U-net是一个在全卷积神经网络的基础上改进优化的网络结构，由特征提取收缩路径和上采样扩张路径组成，整体类似于英文字母U，因而得名。



<center><b>图3 U-net网络结构示意图</b></center>

​        由于医学图像语义简单、结构固定，高级语义信息和低级特征都很重要，而U-net通过底层信息和高层信息结合，能够显著提高分割的精度。根据训练需要，考生网络采用4层U-net，考官网络采用3层。训练时通过计算平衡交叉熵损失函数（**Balanced Cross-Loss**）来不断更新调整网络权重参数，从而训练网络提高分割结果的准确性。

​        在考官网络中，采用全监督学习，以冠脉管腔标签为输入，高斯增强的冠脉中心线信息为标签进行训练，计算损失函数，令其学习管腔拓扑结构的特征。与此同时，在考生网络中输入心脏原图像，以管腔标签作为约束，将考生网络的分割结果与标签计算损失，反馈至考生网络。最后，将考生网络输出的冠脉分割结果作为输入送到考官网络中，令经受训练的考官网络对其进行评估和优化，再次通过损失函数反作用于考生网络。如此结合了管腔分割特征训练和考官网络评估反馈，对考生网络实现了效果较好的弱监督图像分割学习。



<center><b>图4 考生-考官训练模型示意图</b></center>

​        此方法相比以原图像作为输入的全监督学习，所需标签训练集显著减少，符合我们的设计理念。

#### 可视化程序部分：



### 4.作品意义

​        如今，智能诊断已经成为了临床疾病诊断的发展趋势。作为智能诊断中重要也是主要的一部分，神经网络的设计和改进推动着对应诊断任务的发展。我们的考生-考官训练模型成功克服了医学图像数据集普遍存在的数据少、标签难获取等问题，在心脏冠脉分割任务上取得了令人满意的效果。由此进行推广，该模型也可以应用在其他的医学图像分割问题中，具有很大的发展和应用潜力。

​        我们的可视化应用程序使用门槛低，直观清晰，易于交互，作为辅助冠脉疾病诊断的工具可以很好的提高医生诊断的效率和精确度。对于医院和医生而言，可以降低成本、提升效率；对于患者而言，可以得到更加精准的诊断和及时的治疗，诊疗费用也会降低。综上所述，我们的作品在理论和实际领域都有较好的应用价值。